#include <iostream>
using namespace std;

const int MAX_SIZE = 100; // Maximum size of the array

// Function prototypes
void mainMenu(int arr[], int& size);
void searchingMenu(int arr[], int size);
void sortingMenu(int arr[], int size);
int linearSearch(const int arr[], int size, int key);
int binarySearch(const int arr[], int size, int key);
void bubbleSort(int arr[], int size);
void selectionSort(int arr[], int size);
void insertionSort(int arr[], int size);
void binaryInsertionSort(int arr[], int size);
void simpleSort(int arr[], int size); // Simple Sort function prototype
void printArray(const int arr[], int size);
void inputArray(int arr[], int& size);

// Main Menu
void mainMenu(int arr[], int& size) {
    int choice;
    do {
        cout << "\n--- Main Menu ---" << endl;
        cout << "1. Input Array" << endl;
        cout << "2. Searching" << endl;
        cout << "3. Sorting" << endl;
        cout << "4. Exit" << endl;
        cout << "Enter your choice: ";
        cin >> choice;

        switch (choice) {
        case 1:
            inputArray(arr, size); // Input array elements from the user
            break;
        case 2:
            if (size == 0) {
                cout << "Array is empty. Please input the array first.\n";
            } else {
                searchingMenu(arr, size);
            }
            break;
        case 3:
            if (size == 0) {
                cout << "Array is empty. Please input the array first.\n";
            } else {
                sortingMenu(arr, size);
            }
            break;
        case 4:
            cout << "Exiting the program..." << endl;
            break;
        default:
            cout << "Invalid choice! Please try again." << endl;
        }
    } while (choice != 4);
}

// Searching Menu
void searchingMenu(int arr[], int size) {
    int choice, key;
    do {
        cout << "\n--- Searching Menu ---" << endl;
        cout << "1. Linear Search" << endl;
        cout << "2. Binary Search" << endl;
        cout << "3. Back to Main Menu" << endl;
        cout << "Enter your choice: ";
        cin >> choice;

        switch (choice) {
        case 1:
            cout << "Enter the key to search: ";
            cin >> key;
            if (linearSearch(arr, size, key) != -1)
                cout << "Element found at index " << linearSearch(arr, size, key) << endl;
            else
                cout << "Element not found." << endl;
            break;
        case 2:
            cout << "Enter the key to search: ";
            cin >> key;
            if (binarySearch(arr, size, key) != -1)
                cout << "Element found at index " << binarySearch(arr, size, key) << endl;
            else
                cout << "Element not found." << endl;
            break;
        case 3:
            cout << "Returning to main menu..." << endl;
            break;
        default:
            cout << "Invalid choice! Please try again." << endl;
        }
    } while (choice != 3);
}

// Sorting Menu
void sortingMenu(int arr[], int size) {
    int choice;
    do {
        cout << "\n--- Sorting Menu ---" << endl;
        cout << "1. Bubble Sort" << endl;
        cout << "2. Selection Sort" << endl;
        cout << "3. Insertion Sort" << endl;
        cout << "4. Binary Insertion Sort" << endl;
        cout << "5. Simple Sort" << endl;
        cout << "6. Back to Main Menu" << endl;
        cout << "Enter your choice: ";
        cin >> choice;

        switch (choice) {
        case 1:
            bubbleSort(arr, size);
            cout << "Array sorted using Bubble Sort: ";
            printArray(arr, size);
            break;
        case 2:
            selectionSort(arr, size);
            cout << "Array sorted using Selection Sort: ";
            printArray(arr, size);
            break;
        case 3:
            insertionSort(arr, size);
            cout << "Array sorted using Insertion Sort: ";
            printArray(arr, size);
            break;
        case 4:
            binaryInsertionSort(arr, size);
            cout << "Array sorted using Binary Insertion Sort: ";
            printArray(arr, size);
            break;
        case 5:
            simpleSort(arr, size);
            cout << "Array sorted using Simple Sort: ";
            printArray(arr, size);
            break;
        case 6:
            cout << "Returning to main menu..." << endl;
            break;
        default:
            cout << "Invalid choice! Please try again." << endl;
        }
    } while (choice != 6);
}

// Linear Search
int linearSearch(const int arr[], int size, int key) {
    for (int i = 0; i < size; i++) {
        if (arr[i] == key)
            return i;
    }
    return -1;
}

// Binary Search (requires sorted array)
int binarySearch(const int arr[], int size, int key) {
    int low = 0, high = size - 1;
    while (low <= high) {
        int mid = (low + high) / 2;
        if (arr[mid] == key)
            return mid;
        else if (arr[mid] < key)
            low = mid + 1;
        else
            high = mid - 1;
    }
    return -1;
}

// Bubble Sort
void bubbleSort(int arr[], int size) {
    for (int i = 0; i < size - 1; i++) {
        for (int j = 0; j < size - 1 - i; j++) {
            if (arr[j] > arr[j + 1])
                swap(arr[j], arr[j + 1]);
        }
    }
}

// Selection Sort
void selectionSort(int arr[], int size) {
    for (int i = 0; i < size - 1; i++) {
        int minIndex = i;
        for (int j = i + 1; j < size; j++) {
            if (arr[j] < arr[minIndex])
                minIndex = j;
        }
        swap(arr[i], arr[minIndex]);
    }
}

// Insertion Sort
void insertionSort(int arr[], int size) {
    for (int i = 1; i < size; i++) {
        int key = arr[i];
        int j = i - 1;
        while (j >= 0 && arr[j] > key) {
            arr[j + 1] = arr[j];
            j--;
        }
        arr[j + 1] = key;
    }
}

// Binary Insertion Sort
void binaryInsertionSort(int arr[], int size) {
    for (int i = 1; i < size; i++) {
        int key = arr[i];
        int low = 0, high = i - 1;
        while (low <= high) {
            int mid = (low + high) / 2;
            if (arr[mid] > key)
                high = mid - 1;
            else
                low = mid + 1;
        }
        for (int j = i - 1; j >= low; j--) {
            arr[j + 1] = arr[j];
        }
        arr[low] = key;
    }
}

// Simple Sort (Exchange Sort)
void simpleSort(int arr[], int size) {
    for (int i = 0; i < size - 1; i++) {
        for (int j = i + 1; j < size; j++) {
            if (arr[i] > arr[j]) {
                swap(arr[i], arr[j]);
            }
        }
    }
}

// Function to print array
void printArray(const int arr[], int size) {
    for (int i = 0; i < size; i++) {
        cout << arr[i] << " ";
    }
    cout << endl;
}

// Function to input array from user
void inputArray(int arr[], int& size) {
    cout << "Enter the number of elements (max " << MAX_SIZE << "): ";
    cin >> size;
    if (size > MAX_SIZE || size < 1) {
        cout << "Invalid size! Please enter a size between 1 and " << MAX_SIZE << ".\n";
        size = 0;
        return;
    }

    cout << "Enter " << size << " elements:\n";
    for (int i = 0; i < size; i++) {
        cin >> arr[i];
    }
}

int main() {
    int arr[MAX_SIZE];  // Array to hold user input
    int size = 0;       // Number of elements in the array (starts as 0)
    mainMenu(arr, size);
    return 0;
}
